<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	
		<meta name="og:description" content="This article is now outdated and the code no longer works with modern versions of iTunes. Please read my updated article to see how to create an AirPlay alarm clock with iTunes 11 and iTunes 12.Original article:">
	
	<link href='https://fonts.googleapis.com/css?family=PT+Sans+Caption:400,700' rel='stylesheet' type='text/css'>
	<link rel="alternate" type="application/rss+xml" title="The Blog of Ben Dodson - iPhone Developer and WallaBee Founder" href="https://bendodson.com/rss.xml" />
	<link rel="stylesheet" href="/styles-2016-04-18.css" />
	<link rel="stylesheet" href="/highlight.css" />
	<link rel="icon" href="https://bendodson.s3.amazonaws.com/bendodson.com/favicon.ico">
	<link rel="apple-touch-icon" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-iphone.png">
	<link rel="apple-touch-icon" sizes="76x76" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-ipad.png">
	<link rel="apple-touch-icon" sizes="120x120" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-iphone-retina.png">
	<link rel="apple-touch-icon" sizes="152x152" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-ipad-retina.png">
	<link rel="apple-touch-icon" sizes="180x180" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-ipad-retina.png">
	<title>The AirPlay Alarm Clock: Turning an Apple TV or Airport Express into an Alarm Clock with AppleScript</title>
</head>
<body>

	<div id="wrapper">

		<header>
			<hgroup>
				<h1><a href="/">Ben Dodson</a></h1>
				<h2>Freelance iOS, Apple Watch, and Apple TV Developer</h2>
			</hgroup>
			<nav>
				<ul>
					<li><a href="/">Home</a></li><li><a href="/weblog/">Blog</a></li><li><a href="/about/">About</a></li><li><a href="/clients/">Portfolio</a></li><li><a href="/apps/">My Apps</a></li><li><a href="/projects/">Projects</a></li><li><a href="/contact/">Contact</a></li>
				</ul>
				<div class="divider"></div>
			</nav>
		</header>

		<section id="posts">
	<article>
		<header>
     		
				<h1><a href="/weblog/2011/01/10/the-airplay-alarm-clock-turning-an-apple-tv-or-airport-express-into-an-alarm-clock-with-applescript/">The AirPlay Alarm Clock: Turning an Apple TV or Airport Express into an Alarm Clock with AppleScript</a></h1>
			
			<time datetime="2011-01-10" pubdate=""><a href="/weblog/2011/01/10/the-airplay-alarm-clock-turning-an-apple-tv-or-airport-express-into-an-alarm-clock-with-applescript/">January 10, 2011</a></time>
    	</header>
    	<div>
			<p><strong>This article is now outdated and the code no longer works with modern versions of iTunes. Please read my <a href="https://bendodson.com/weblog/2016/05/12/airplay-alarm-clock-with-itunes-12/">updated article</a> to see how to create an AirPlay alarm clock with iTunes 11 and iTunes 12.</strong></p>
<p><strong>Original article:</strong></p>

<p>I was recently reading through some of my old blog posts when I discovered an article that is still fairly popular about <a href="https://bendodson.com/weblog/2008/09/08/control-mac-mini-from-iphone-with-waking-sleeping-audio-video/">controlling a mac mini via an iPhone</a>.  I had an old mac mini lying around and so installed it in my bedroom as a device which basically acted as an iTunes library and alarm clock.  Times have changed though and I no longer have a mac mini in my bedroom; I have an Apple TV.  With the recent news about iPhone alarm clocks failing to go off (again) and lots of hacking projects with AirPlay to try and stream more than just YouTube videos, I decided to work on something this evening I've been thinking about for a little while; turning my Apple TV into an Alarm Clock.  The basic idea is that at a set time in the morning, the Apple TV will wake itself up automatically and start playing a set playlist from my shared iTunes library.  The first step would be to get audio playlists working, but the ultimate goal would be to have video alarms as well.  Thanks to a bit of AppleScript, I've managed to cook up a basic app to do just that.</p>

<p>So, how does one go about creating an AirPlay Alarm Clock?  First of all, you will need a mac that is turned on with a shared iTunes library of content. The "turned on" bit can be automated from System Settings i.e. your machine can be asleep but told to wake up 5 minutes before your alarm is due to go off if you want to save energy.  You will also need an AirPlay compatible device - this can be a set of speakers plugged into an Airport Express, one of the new AirPlay compatible iHome speaker systems, or an Apple TV.  Please note that video playback will obviously only work on the Apple TV although you will get the audio from the video if you select an audio-only device.  Once you've got those, you'll need to make a small tweak to your OS X setup: if you go into System Preferences and then Universal Access, you'll need to enable access for assistive devices - this is so AppleScript can make keypresses on your behalf.</p>

<p>Ok, on to the code:</p>

<div class="highlight"><pre><code class="language-applescript" data-lang="applescript"><span class="k">set</span> <span class="nv">AppleTVName</span> <span class="k">to</span> <span class="s2">&quot;Bedroom Apple TV&quot;</span>
<span class="k">set</span> <span class="nv">PlaylistName</span> <span class="k">to</span> <span class="s2">&quot;Alarm&quot;</span>

<span class="nb">activate</span> <span class="nb">application</span> <span class="s2">&quot;iTunes&quot;</span>
<span class="nb">delay</span> <span class="mf">0.2</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;System Events&quot;</span>
	<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;iTunes&quot;</span>
		<span class="k">set</span> <span class="na">visible</span> <span class="k">of</span> <span class="nb">front</span> <span class="nb">browser</span> <span class="na">window</span> <span class="k">to</span> <span class="no">true</span>
                <span class="k">set</span> <span class="nb">the</span> <span class="na">view</span> <span class="k">of</span> <span class="nb">the</span> <span class="nb">front</span> <span class="nb">browser</span> <span class="na">window</span> <span class="k">to</span> <span class="nv">playlist</span> <span class="nv">PlaylistName</span>
	<span class="k">end</span> <span class="k">tell</span>
	<span class="nb">delay</span> <span class="mf">0.2</span>

	<span class="k">tell</span> <span class="na">window</span> <span class="s2">&quot;iTunes&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="nv">process</span> <span class="s2">&quot;iTunes&quot;</span>
		<span class="nv">click</span> <span class="nb">button</span> <span class="mi">10</span> <span class="k">of</span> <span class="na">window</span> <span class="s2">&quot;iTunes&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="nv">process</span> <span class="s2">&quot;iTunes&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="s2">&quot;System Events&quot;</span>
		<span class="na">key code</span> <span class="mi">125</span> <span class="nv">using</span> <span class="p">{</span><span class="nv">command</span> <span class="nv">down</span><span class="p">}</span>
		<span class="nb">delay</span> <span class="mf">0.2</span>
		<span class="nv">keystroke</span> <span class="no">return</span>

		<span class="nb">delay</span> <span class="mf">0.2</span>

		<span class="k">tell</span> <span class="na">window</span> <span class="s2">&quot;Multiple Speakers&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="nv">process</span> <span class="s2">&quot;iTunes&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="s2">&quot;System Events&quot;</span>
			<span class="nb">activate</span>
			<span class="nv">click</span> <span class="nb">button</span> <span class="mi">2</span>
			<span class="k">tell</span> <span class="nv">table</span> <span class="mi">1</span> <span class="k">of</span> <span class="nb">scroll</span> <span class="nv">area</span> <span class="mi">1</span>
				<span class="nb">activate</span>
				
				<span class="k">repeat</span> <span class="nv">with</span> <span class="nv">i</span> <span class="k">from</span> <span class="mi">1</span> <span class="k">to</span> <span class="p">(</span><span class="nb">count</span> <span class="k">of</span> <span class="nb">every</span> <span class="nv">row</span><span class="p">)</span>
					<span class="k">set</span> <span class="nv">rowcount</span> <span class="k">to</span> <span class="nb">count</span> <span class="k">of</span> <span class="nv">rows</span>
					<span class="k">if</span> <span class="nv">rowcount</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">then</span>
						<span class="k">tell</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">row</span> <span class="nv">i</span>
							<span class="nb">activate</span>
							<span class="k">if</span> <span class="nv">description</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="k">as </span><span class="nc">string</span> <span class="o">=</span> <span class="nv">AppleTVName</span> <span class="ow">and</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
								<span class="k">set</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="k">to</span> <span class="mi">1</span>
								<span class="nb">delay</span> <span class="mf">0.5</span>
							<span class="k">end</span> <span class="k">if</span>
						<span class="k">end</span> <span class="k">tell</span>
					<span class="k">end</span> <span class="k">if</span>
				<span class="k">end</span> <span class="k">repeat</span>
				
				<span class="k">repeat</span> <span class="nv">with</span> <span class="nv">i</span> <span class="k">from</span> <span class="mi">1</span> <span class="k">to</span> <span class="p">(</span><span class="nb">count</span> <span class="k">of</span> <span class="nb">every</span> <span class="nv">row</span><span class="p">)</span>
					<span class="k">set</span> <span class="nv">rowcount</span> <span class="k">to</span> <span class="nb">count</span> <span class="k">of</span> <span class="nv">rows</span>
					<span class="k">if</span> <span class="nv">rowcount</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">then</span>
						<span class="k">tell</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">row</span> <span class="nv">i</span>
							<span class="nb">activate</span>
							<span class="k">if</span> <span class="nv">description</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="k">as </span><span class="nc">string</span> <span class="ow">does not equal</span> <span class="nv">AppleTVName</span> <span class="ow">and</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">then</span>
								<span class="k">set</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="k">to</span> <span class="mi">0</span>
								<span class="nb">delay</span> <span class="mf">0.2</span>
							<span class="k">end</span> <span class="k">if</span>
						<span class="k">end</span> <span class="k">tell</span>
					<span class="k">end</span> <span class="k">if</span>
				<span class="k">end</span> <span class="k">repeat</span>
				
			<span class="k">end</span> <span class="k">tell</span>
		<span class="k">end</span> <span class="k">tell</span>
	<span class="k">end</span> <span class="k">tell</span>

	<span class="k">tell</span> <span class="na">window</span> <span class="s2">&quot;Multiple Speakers&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="nv">process</span> <span class="s2">&quot;iTunes&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="s2">&quot;System Events&quot;</span>
		<span class="nb">activate</span>
		<span class="nv">click</span> <span class="nb">button</span> <span class="mi">3</span>
	<span class="k">end</span> <span class="k">tell</span>
<span class="k">end</span> <span class="k">tell</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;iTunes&quot;</span>
	<span class="k">set</span> <span class="nv">shuffle</span> <span class="k">of</span> <span class="nv">playlist</span> <span class="nv">PlaylistName</span> <span class="k">to</span> <span class="mi">1</span>
	<span class="nb">play</span> <span class="nv">playlist</span> <span class="nv">PlaylistName</span>
<span class="k">end</span> <span class="k">tell</span></code></pre></div>

<p>I'll explain all of that in a bit more detail shortly, but for those of you that want to get cracking, you can copy and paste that into the AppleScript Editor that comes free with every copy of OS X.  You'll want to tweak the first two lines so that the variables match the name of your device and your playlist.  Once that is done, you can save the script as an application.  To get the alarm to play automagically in the mornings, you can open up iCal and create a new event (it can be recurring if you want a daily alarm).  In the "alarm" section, there is a little known entry called "run script" which you can use to run an AppleScript at a specified time relative to the alarm.  If you choose the script you saved, then it will automatically run at the allotted time.  Simple!</p>

<p><strong>Warning:</strong> This script is currently set to shuffle your playlist so that you don't get the same song every morning.  However, if you want to playback video, you have to disable the shuffling as iTunes doesn't like playing shuffled video playlists over AirPlay for some reason.  To do that, you need to edit the 3rd line from the bottom in the AppleScript to say "<code>set shuffle of playlist PlaylistName to 0</code>".</p>

<p>If you're a geeky sort of person, you'll probably want to know how all of that script works.  Here is a quick breakdown of each section:</p>

<div class="highlight"><pre><code class="language-applescript" data-lang="applescript"><span class="k">set</span> <span class="nv">AppleTVName</span> <span class="k">to</span> <span class="s2">&quot;Bedroom Apple TV&quot;</span>
<span class="k">set</span> <span class="nv">PlaylistName</span> <span class="k">to</span> <span class="s2">&quot;Alarm&quot;</span>

<span class="nb">activate</span> <span class="nb">application</span> <span class="s2">&quot;iTunes&quot;</span>
<span class="nb">delay</span> <span class="mf">0.2</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;System Events&quot;</span>
	<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;iTunes&quot;</span>
		<span class="k">set</span> <span class="na">visible</span> <span class="k">of</span> <span class="nb">front</span> <span class="nb">browser</span> <span class="na">window</span> <span class="k">to</span> <span class="no">true</span>
                <span class="k">set</span> <span class="nb">the</span> <span class="na">view</span> <span class="k">of</span> <span class="nb">the</span> <span class="nb">front</span> <span class="nb">browser</span> <span class="na">window</span> <span class="k">to</span> <span class="nv">playlist</span> <span class="nv">PlaylistName</span>
	<span class="k">end</span> <span class="k">tell</span>
	<span class="nb">delay</span> <span class="mf">0.2</span></code></pre></div>

<p>The first step is to setup some variables in order to make it as easy as possible to change later on.  The first is the name of your device (as listed in iTunes) and the second is the name of your chosen playlist.  The next two lines tell iTunes to activate (basically open it if it's closed, or bring it to the front if it's already open) and then a short delay to make sure everything has caught up.  You'll notice the line "delay 0.2" in quite a lot of places in this code.  It is there to delay all activity by 0.2 seconds and is required as AppleScript can sometimes run quicker than the buttons it's pressing - by adding the delays every so often, it ensures that you aren't trying to access windows or menus which haven't yet appeared.  If the script isn't working for some reason and you have an old machine, try increasing the delay timeouts first of all as these are usually the culprit.  The next couple of lines force iTunes to make the main window prominent (in case we have any sub-windows hanging around) and also to display the playlist we want to play prominently.  The first version of this script didn't have that and everything generally worked fine so long as the last screen you looked at on iTunes was a music page.  I left a TV show list open and found it no longer worked (caused an error with the button handling) so I've added this section to ensure you are always on the correct page.</p>

<div class="highlight"><pre><code class="language-applescript" data-lang="applescript"><span class="k">tell</span> <span class="na">window</span> <span class="s2">&quot;iTunes&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="nv">process</span> <span class="s2">&quot;iTunes&quot;</span>
	<span class="nv">click</span> <span class="nb">button</span> <span class="mi">10</span> <span class="k">of</span> <span class="na">window</span> <span class="s2">&quot;iTunes&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="nv">process</span> <span class="s2">&quot;iTunes&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="s2">&quot;System Events&quot;</span>
	<span class="na">key code</span> <span class="mi">125</span> <span class="nv">using</span> <span class="p">{</span><span class="nv">command</span> <span class="nv">down</span><span class="p">}</span>
	<span class="nb">delay</span> <span class="mf">0.2</span>
	<span class="nv">keystroke</span> <span class="no">return</span></code></pre></div>

<p>This section controls the little AirPlay button in the bottom right hand corner of iTunes.  You can usually target buttons with their names rather than their index position but the AirPlay button is a special case as it has a different name depending on which device you have selected.  I have 4 different AirPlay devices in my house so rather than writing a big if statement to check for each name and then press accordingly, I instead target the button by it's numerical index.  You can find out the index of UI elements by using the fantastic <a href="http://pfiddlesoft.com/uibrowser/">UI Browser</a> tool - it's a little bit pricey but worth the money if you are planning on doing a lot of AppleScripting.  Once we've told iTunes to click on the button, we use key code 125 (which means the down key) in conjunction with the command button to jump down the entire context list to the "Multiple Speakers..." option.  Originally, I wanted to read the list of devices, iterate through them, and then select the one we wanted but I had a lot of problems getting AppleScript to correctly read the context menu so went for this slightly more longwinded approach instead.  Once the "Multiple Speakers..." option is selected, we hit return to make it open the window.</p>

<div class="highlight"><pre><code class="language-applescript" data-lang="applescript"><span class="k">tell</span> <span class="na">window</span> <span class="s2">&quot;Multiple Speakers&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="nv">process</span> <span class="s2">&quot;iTunes&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="s2">&quot;System Events&quot;</span>
	<span class="nb">activate</span>
	<span class="nv">click</span> <span class="nb">button</span> <span class="mi">2</span>
	<span class="k">tell</span> <span class="nv">table</span> <span class="mi">1</span> <span class="k">of</span> <span class="nb">scroll</span> <span class="nv">area</span> <span class="mi">1</span>
		<span class="nb">activate</span></code></pre></div>

<p>This section is now specifically targeting the "Multiple Speakers" window which we just opened.  The activate command allows us to start interacting with it, and by using UI Browser, we find that button 2 is the maximum volume setting.  I decided to set this manually here (rather than using the existing volume) just in case I had it set really quiet (or muted) for any reason.  This ensures that the music will always come through at it's maximum volume.  The next section lets us select the table listing which shows each device that we are about to iterate through.</p>

<div class="highlight"><pre><code class="language-applescript" data-lang="applescript"><span class="k">repeat</span> <span class="nv">with</span> <span class="nv">i</span> <span class="k">from</span> <span class="mi">1</span> <span class="k">to</span> <span class="p">(</span><span class="nb">count</span> <span class="k">of</span> <span class="nb">every</span> <span class="nv">row</span><span class="p">)</span>
	<span class="k">set</span> <span class="nv">rowcount</span> <span class="k">to</span> <span class="nb">count</span> <span class="k">of</span> <span class="nv">rows</span>
	<span class="k">if</span> <span class="nv">rowcount</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">then</span>
		<span class="k">tell</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">row</span> <span class="nv">i</span>
			<span class="nb">activate</span>
			<span class="k">if</span> <span class="nv">description</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="k">as </span><span class="nc">string</span> <span class="o">=</span> <span class="nv">AppleTVName</span> <span class="ow">and</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
				<span class="k">set</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="k">to</span> <span class="mi">1</span>
				<span class="nb">delay</span> <span class="mf">0.5</span>
			<span class="k">end</span> <span class="k">if</span>
		<span class="k">end</span> <span class="k">tell</span>
	<span class="k">end</span> <span class="k">if</span>
<span class="k">end</span> <span class="k">repeat</span>

<span class="k">repeat</span> <span class="nv">with</span> <span class="nv">i</span> <span class="k">from</span> <span class="mi">1</span> <span class="k">to</span> <span class="p">(</span><span class="nb">count</span> <span class="k">of</span> <span class="nb">every</span> <span class="nv">row</span><span class="p">)</span>
	<span class="k">set</span> <span class="nv">rowcount</span> <span class="k">to</span> <span class="nb">count</span> <span class="k">of</span> <span class="nv">rows</span>
	<span class="k">if</span> <span class="nv">rowcount</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">then</span>
		<span class="k">tell</span> <span class="nv">group</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">row</span> <span class="nv">i</span>
			<span class="nb">activate</span>
			<span class="k">if</span> <span class="nv">description</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="k">as </span><span class="nc">string</span> <span class="ow">does not equal</span> <span class="nv">AppleTVName</span> <span class="ow">and</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">then</span>
				<span class="k">set</span> <span class="nv">value</span> <span class="k">of</span> <span class="nv">checkbox</span> <span class="mi">1</span> <span class="k">to</span> <span class="mi">0</span>
				<span class="nb">delay</span> <span class="mf">0.2</span>
			<span class="k">end</span> <span class="k">if</span>
		<span class="k">end</span> <span class="k">tell</span>
	<span class="k">end</span> <span class="k">if</span>
<span class="k">end</span> <span class="k">repeat</span></code></pre></div>

<p>I'm a big fan of the DRY (don't repeat yourself) principle of coding so you may wonder why there are two loops here which are essentially the same.  The first goes through the list and turns the checkbox on for the device we want to play our alarm through.  The second goes through the same list again, but turns off any devices that aren't our chosen alarm device.  My first thought was to do one loop that went through and turned the checkbox on if the device was correct or off it wasn't.  The problem with that approach is that you can't turn off the Computer audio until you've selected another device.  Therefore, you have to go through once to turn on the chosen device and then through again to turn the others (if they were enabled) off.  A little tedious but this is a bit hacky anyway!  I've updated the delay in the first loop from 0.2 to 0.5 as I found that a 0.2 delay would occasionally not be enough time for an AirPlay speaker to be selected before the next loop comes in and turns of the Computer.  This led to an alert in the script (thus pausing everything not leading to playback) which is obviously not ideal in an alarm clock...</p>

<div class="highlight"><pre><code class="language-applescript" data-lang="applescript"><span class="k">tell</span> <span class="na">window</span> <span class="s2">&quot;Multiple Speakers&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="nv">process</span> <span class="s2">&quot;iTunes&quot;</span> <span class="k">of</span> <span class="nb">application</span> <span class="s2">&quot;System Events&quot;</span>
	<span class="nb">activate</span>
	<span class="nv">click</span> <span class="nb">button</span> <span class="mi">3</span>
<span class="k">end</span> <span class="k">tell</span></code></pre></div>

<p>Just for the sake of tidiness, this tell will close the "Multiple Speakers" window we opened.</p>

<div class="highlight"><pre><code class="language-applescript" data-lang="applescript"><span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;iTunes&quot;</span>
	<span class="k">set</span> <span class="nv">shuffle</span> <span class="k">of</span> <span class="nv">playlist</span> <span class="nv">PlaylistName</span> <span class="k">to</span> <span class="mi">1</span>
	<span class="nb">play</span> <span class="nv">playlist</span> <span class="nv">PlaylistName</span>
<span class="k">end</span> <span class="k">tell</span></code></pre></div>

<p>This final section tells iTunes to shuffle our playlist (remember to turn the shuffle off &mdash; set shuffle of playlist PlaylistName to 0 &mdash; if you are going to send video via AirPlay) and then play it.</p>

<p>And there you have it! A small piece of AppleScript to enable audio and video alarms over AirPlay.  If you have any comments or suggestions, please <a href="/contact/">get in touch</a>.</p>

<p><strong>Update [11th Jan 2011]:</strong> I've amended two sections of the code.  Firstly, I've added a line near the top which ensures that the playlist you want to play is selected and displayed as the main view.  Previous versions worked perfectly when I tested them as I was in the "Music" section of iTunes but if you are in a video section (e.g. left on a TV show page) then there would be an error as it couldn't find the AirPlay button (as the index was different).  The second change is a delay in the looping section has been increased from 0.2 to 0.5 as occasionally it took slightly longer than 0.2 seconds to select an AirPlay speaker. This caused a problem as the script would alert causing everything to pause.  Both lines have been amended in the code at the top of the page and in the analysis afterwards.</p>

<p><strong>Update [25th Oct 2011]:</strong> The button codes have changed in iTunes 10.4 and 10.5 so I've updated the above script so it will continue to work. The key part was changing <code>click button 8 of window "iTunes" of application process</code> to <code>click button 10 of window "iTunes" of application process</code>. Thanks to Thomas Engbjerg for letting me know it was broken!</p>

<p><strong>Update [25th Jan 2012]:</strong> I've added this code to <a href="https://github.com/bendodson/Apple-TV-Alarm-Clock">GitHub</a> for easier managing. If something should break in the future (looking at you iTunes 10.6) then a fix will be put up there.</p>

<p><strong>Update [15th Mar 2012]:</strong> iTunes 10.6 did break as expected - needed to add a <code>delay 0.2</code> before the call to speak with the <code>"Multiple Speakers"</code> window due to some newly introduced lag. Updated here and on <a href="https://github.com/bendodson/Apple-TV-Alarm-Clock">GitHub</a>.</p>

<p><strong>Update [12th May 2016]:</strong> This article is now outdated and the code no longer works with modern versions of iTunes. Please read my <a href="https://bendodson.com/weblog/2016/05/12/airplay-alarm-clock-with-itunes-12/">updated article</a> to see how to create an AirPlay alarm clock with iTunes 11 and iTunes 12.</p>
		</div>
	</article>
</section>

<section id="pagination">
	 
		<a href="/weblog/2011/01/11/thoughts-on-the-verizon-iphone-4/" title="Next Article" class="pagination-next">Thoughts on the Verizon iPhone 4 &raquo;</a>
    
	 
		<a href="/weblog/2011/01/09/the-coversutra-saga/" title="Previous Article" class="pagination-previous">&laquo; The CoverSutra Saga</a>
    
</section>
		
		<footer>
			<p>I perform all freelance work through my company <strong>Dodo Apps Ltd</strong> (07856552) registered at The Bristol Office, 2nd Floor, 5 High Street, Westbury on Trym, Bristol, England, BS9 3BY</p>
		</footer>

	</div>


</body>
</html>
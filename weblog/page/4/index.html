<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	
	<link href='https://fonts.googleapis.com/css?family=PT+Sans+Caption:400,700' rel='stylesheet' type='text/css'>
	<link rel="alternate" type="application/rss+xml" title="The Blog of Ben Dodson - iPhone Developer and WallaBee Founder" href="https://bendodson.com/rss.xml" />
	<link rel="stylesheet" href="/styles-2016-04-18.css" />
	<link rel="stylesheet" href="/highlight.css" />
	<link rel="icon" href="https://bendodson.s3.amazonaws.com/bendodson.com/favicon.ico">
	<link rel="apple-touch-icon" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-iphone.png">
	<link rel="apple-touch-icon" sizes="76x76" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-ipad.png">
	<link rel="apple-touch-icon" sizes="120x120" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-iphone-retina.png">
	<link rel="apple-touch-icon" sizes="152x152" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-ipad-retina.png">
	<link rel="apple-touch-icon" sizes="180x180" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-ipad-retina.png">
	<title>Ben Dodson's Blog &mdash; Freelance Swift Developer and WallaBee Founder</title>
</head>
<body>

	<div id="wrapper">

		<header>
			<hgroup>
				<h1><a href="/">Ben Dodson</a></h1>
				<h2>Freelance iOS, Apple Watch, and Apple TV Developer</h2>
			</hgroup>
			<nav>
				<ul>
					<li><a href="/">Home</a></li><li><a href="/weblog/">Blog</a></li><li><a href="/about/">About</a></li><li><a href="/clients/">Portfolio</a></li><li><a href="/apps/">My Apps</a></li><li><a href="/projects/">Projects</a></li><li><a href="/contact/">Contact</a></li>
				</ul>
				<div class="divider"></div>
			</nav>
		</header>

		<section id="posts">

	
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/03/15/show-me-the-next/">Show Me The Next</a></h1>
			
			<time datetime="2016-03-15" pubdate=""><a href="/weblog/2016/03/15/show-me-the-next/">March 15, 2016</a></time>
    	</header>
    	<div>
			<p>An iOS app I worked on for <a href="http://thebrowser.com/">The Browser</a> has gone live in the App Store today; <a href="https://itunes.apple.com/us/app/show-me-the-next/id1079373733?ls=1&amp;mt=8">Show Me The Next</a>:
<img src="https://bendodson.s3.amazonaws.com/apps/show-me-the-next.jpg" width="800" height="468" /></p>

<p>The concept is very simple; an app with curated articles that you read through at random with a simple swipe. No going back, no list no images, no videos, and no tracking; just fast offline access to interesting articles.</p>

<p>I made a quick mockup and then I added some extra features such as the ability to share articles, alter the font size, and change screen brightness<sup id="fnref:clientrequest"><a href="#fn:clientrequest" class="footnote">1</a></sup>. I also built a simple CMS so that the articles embedded in the app could be updated remotely. The app is built using Swift 2.1, runs on all devices with iOS 9 or above, and is optimised for all the various shapes and sizes including iPad split screens.</p>

<p><img src="https://bendodson.s3.amazonaws.com/weblog/2016/smtn-logo.jpg" width="800" height="468" />
As well as completely designing the app and the functionality, I was also asked to design the app icon and logo with a simple single sentence brief: <em>“I admire the art of <a href="https://en.wikipedia.org/wiki/Piet_Mondrian">Mondrian</a>“</em>. I took inspiration from the work <em><a href="https://en.wikipedia.org/wiki/Piet_Mondrian#/media/File:Piet_Mondriaan,_1930_-_Mondrian_Composition_II_in_Red,_Blue,_and_Yellow.jpg">Composition II in Red, Blue, and Yellow</a></em> and used the same colours and textures with lines to shape the letters SMTN. It was a fun design experiment and something a bit different for me!</p>

<p>Show Me The Next is a free app and is <a href="https://itunes.apple.com/us/app/show-me-the-next/id1079373733?ls=1&amp;mt=8">available on the App Store</a>.</p>

<div class="footnotes">
  <ol>
    <li id="fn:clientrequest">
      <p>The client did not ask for these additions but I often like to add extra functionality free of charge when I feel it is of benefit to the app. <a href="#fnref:clientrequest" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/03/15/music-tracker-1-3/">Music Tracker v1.3</a></h1>
			
			<time datetime="2016-03-15" pubdate=""><a href="/weblog/2016/03/15/music-tracker-1-3/">March 15, 2016</a></time>
    	</header>
    	<div>
			<p>I’m very happy to announce that v1.3 of <a href="https://dodoapps.io/music-tracker/">Music Tracker</a> is now available as a free update.
<img src="https://bendodson.s3.amazonaws.com/weblog/2016/music-tracker-5c.jpg" width="800" height="400" /></p>

<p>In this version, I’ve focused on speed and stability. The original scanning engine has been completely rewritten from the ground up and now runs faster and for larger libraries than ever before.</p>

<p>Previously, the app would wake up once an hour and have around 30 seconds in order to scan the library, look for additions, changes, and deletions, and then save all of that information locally. This worked great for small libraries on newer devices like the iPhone 6s but didn’t work so well on an iPhone 5s with a library of over 75000 songs. The reason for this is that iOS limits the amount of time an app can run in the background<sup id="fnref:sensible"><a href="#fn:sensible" class="footnote">1</a></sup>; if the entirity of the process wasn’t complete in the time allowed, then it would simply fail. This meant that customers with large libraries were typically seeing no updates as the app wasn’t able to get through the entirity of the library within the 30 second window allowed.</p>

<p>To fix this, I rewrote the scanning engine to be faster but to also work in batches. If iOS terminates the Music Tracker process (as it is taking too long) then the current state is saved and will pick up from where it left off the next time the process is restarted<sup id="fnref:process"><a href="#fn:process" class="footnote">2</a></sup>. This means that huge libraries can now be scanned correctly as they are broken up over a few passes rather than trying to do it all at once. A nice side benefit of this is that the app can now handle older hardware<sup id="fnref:hardware"><a href="#fn:hardware" class="footnote">3</a></sup> which previously was too slow to handle even small libraries in a single pass.</p>

<p><img src="https://bendodson.s3.amazonaws.com/weblog/2016/music-tracker-sync.jpg" width="800" height="400" />
In order to accomodate this new multi-pass scanning engine, I’ve also changed the way in which manual updates are performed within the app. Previously you could “pull to refresh” on the main activity page; this gave you a little spinner icon and not much detail as to what was happening. In v1.3, there is a refresh icon in the top right hand corner that will take you to a new page which details exactly what is going on and shows a progress bar so you can see that it is actually working.</p>

<p>If you have already purchased Music Tracker, you should see v1.3 as a free update within the App Store; you can check which version you have installed by going to the settings page within the app. If you don’t yet have Music Tracker, you can get it on the <a href="https://itunes.apple.com/us/app/music-tracker-automatic-tracking/id1062583712?ls=1&amp;mt=8">App Store</a>. For more details about the app, you can view the <a href="https://dodoapps.io/music-tracker/">official website at Dodo Apps</a>.</p>

<p>One final thing: on the <a href="https://dancounsell.com/articles/a-better-format-for-press-kits">advice of Dan Counsell</a>, I’ve changed my <a href="https://dodoapps.io/music-tracker/media-kit/">press media kit</a> to be a standard HTML page with full access to everything the old zip download contained including details of the app, screenshots, icons, and mockup images. This makes it easier for the many iOS journalists who have switched to using something like the iPad Pro as their main work machine which doesn’t handle zip files particularly well. You can <a href="https://dodoapps.io/music-tracker/media-kit/">check out the online media kit</a> or <a href="https://bendodson.s3.amazonaws.com/dodo/music-tracker-media-kit.zip">download the media kit as a zip file</a>.</p>

<div class="footnotes">
  <ol>
    <li id="fn:sensible">
      <p>This is a sensible thing; tasks should not be allowed to run for large periods of time in the background otherwise they’ll kill your battery. <a href="#fnref:sensible" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:process">
      <p>Music Tracker typically wakes up every hour to check for changes. <a href="#fnref:process" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:hardware">
      <p>Previously the app was only available on devices with a 64-bit chip. Music Tracker now runs on any device capable of running iOS 9.0 which means the iPhone 4s, iPhone 5, and iPhone 5c are now supported. <a href="#fnref:hardware" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/03/11/brapp-v2/">Brapp 2.0</a></h1>
			
			<time datetime="2016-03-11" pubdate=""><a href="/weblog/2016/03/11/brapp-v2/">March 11, 2016</a></time>
    	</header>
    	<div>
			<p>Over the last couple of months, I’ve been working with <a href="https://www.brapp.tv">Brapp</a> on their <a href="https://itunes.apple.com/us/app/brapp-rap-sing-or-dance-to/id1022327727?mt=8">v2.0 release</a> which adds a ton of new features for video makers, producers, and music lovers.</p>

<p><img src="https://bendodson.s3.amazonaws.com/weblog/2016/brapp-audio.jpg" width="800" height="542" /></p>

<p>For video makers, there is a huge improvement to the record and upload flow allowing for studio grade Audio FX such as Pump (compression), EQ, bpm centric Delays, and Reverb<sup id="fnref:anotherdev"><a href="#fn:anotherdev" class="footnote">1</a></sup> with adjustments occuring in real time. You can tap on the camera view to adjust exposure and light balance and the recording quality has been improved. Finally, you can now save videos locally complete with a watermark with your name and the beat creator if applicable.</p>

<p><img src="https://bendodson.s3.amazonaws.com/weblog/2016/brapp-beat-trim.jpg" width="800" height="450" /></p>

<p>For producers, there is now a systemwide ability to import beats from any app that displays media files. Just tap the share icon and choose the new “Copy to Brapp” option. This will take you to a new editing page that lets you trim the beat to a minute or less in length and add optional fades in or out. The trim page was particularly difficult to build (as you have real time scrubbing and fades, waveform generation, and the ability to move the waveform before you even get to outputting these to a single audio file) but the end result works beautifully.</p>

<p><img src="https://bendodson.s3.amazonaws.com/weblog/2016/brapp-profile.jpg" width="800" height="450" /></p>

<p>In addition to these big features, there are 100s<sup id="fnref:literally"><a href="#fn:literally" class="footnote">2</a></sup> of smaller changes including:</p>

<ul>
  <li>The new profile system makes it possible to hide reposts on a profile so you can just check out their beats and videos.</li>
  <li>Search is more powerful than ever.</li>
  <li>It is easier to find new people to follow in the new Explore section.</li>
  <li>You can now see trending hashtags as they happen in Search &gt; Videos/Beats.</li>
  <li>Certified. OGs on Brapp will now have the Certified icon by their name<sup id="fnref:certified"><a href="#fn:certified" class="footnote">3</a></sup>.</li>
  <li>It is now easier to find beats that are used in videos.</li>
  <li>It is now easier to save beats you like with the new “Save Beat” button.</li>
  <li>You now get notifications on reposts, so you can see when your followers react to your reposts.</li>
  <li>Check out your Mug Shot in Profile &gt; Settings.</li>
  <li>You can now see all the beats and videos you have Liked in Settings &gt; My Likes.</li>
  <li>It is now easier to Invite friends to Brapp via Facebook or SMS.</li>
  <li>Lots of stability and speed improvements.</li>
</ul>

<p>Finally, previous versions of the app were written in Swift 1.2 using Xcode 6.4 and the iOS 8 SDK. With this build, I migrated it to Swift 2.1 using Xcode 7 and the iOS 9 SDK. This means, among other things, that there is now San Francisco rather than Helvetica Neue throughout!</p>

<p>As ever, Brapp has been a really fun project to work on. I can’t say enough good things about the people behind it and I really believe this app is going to be a big deal. If you haven’t checked it out yet, you can <a href="https://itunes.apple.com/us/app/brapp-rap-sing-or-dance-to/id1022327727?mt=8">get Brapp for free on the App Store</a>. You can also read about the <a href="https://bendodson.com/weblog/2015/09/25/brapp-the-rap-app/">initial build and release</a> and the <a href="https://bendodson.com/weblog/2015/11/27/brapp-v1.1/">v1.1 update last November</a>.</p>

<div class="footnotes">
  <ol>
    <li id="fn:anotherdev">
      <p>The audio filters were written by <a href="http://bangmeansdoit.co.uk/en/">David Gibson</a>; I did the integration with the Brapp project and UI. <a href="#fnref:anotherdev" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:literally">
      <p>Literally. <a href="#fnref:literally" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:certified">
      <p>I am currently certified though I don’t think I will be for long bearing in mind I only have two ‘raps’ and I’m miming in both of them. I did record some sick beats during development but I deleted them pretty quick after recording! <a href="#fnref:certified" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/03/10/sunday-isnt-special/">Sunday Isn't Special</a></h1>
			
			<time datetime="2016-03-10" pubdate=""><a href="/weblog/2016/03/10/sunday-isnt-special/">March 10, 2016</a></time>
    	</header>
    	<div>
			<p>Last night, the <a href="http://www.bbc.co.uk/news/uk-politics-35768674">Government lost a vote</a> in the House of Commons to change Sunday Trading Laws in the UK. I don’t usually blog about politics<sup id="fnref:politics"><a href="#fn:politics" class="footnote">1</a></sup> but Sunday Trading has been a big issue for me and, as a freelancer, I am incredibly disappointed that there will be no change in this ridiculously outdated law.</p>

<p>As it stands, there are restrictions on trading for shops over 280m². They may only open for 6 consecutive hours between 10am and 6pm<sup id="fnref:mostshops"><a href="#fn:mostshops" class="footnote">2</a></sup> and there are restrictions on loadings and deliveries. There are some exceptions (such as registered pharmacies, service station outlets, and farms) but pretty much all retail ceases in the UK at 4pm on a Sunday; go to any major supermarket at 3.50pm on a Sunday and you’ll find it packed as people rush to make their purchases before closing time. This is only a fairly recent development though; prior to 1994, the vast majority of shops couldn’t open at all on a Sunday! Thatcher tried to change this in 1986 but was defeated by Labour (protecting workers rights) and her own MPs (concerned with church attendence)<sup id="fnref:thatcher"><a href="#fn:thatcher" class="footnote">3</a></sup>.</p>

<p>In his July budget after the 2015 election, George Osborne announced that the Government wanted to devolve control of Sunday Trading restrictions to local councils so they could decide whether shops could remain open for longer. I personally would have preferred a complete abolition of these rules (as happened during the <a href="http://www.bbc.co.uk/news/uk-18942729">run-up to the 2012 Olympic Games</a>) but would have been happy with at least some move in the right direction. However, the vote was lost last night with Labour, the SNP, and 27 Conservative MPs voting against the motion.</p>

<p>I find this completely unbelievable in the modern age and massively hypocritical on the part of the SNP when Scotland have no restrictions on Sunday Trading<sup id="fnref:snp"><a href="#fn:snp" class="footnote">4</a></sup>. Opposition gathered around a “Keep Sunday Special” motto but to my mind there is absolutely nothing special about Sunday. In the past, you could argue on religious grounds but that is irrelevant in the UK today when Atheism has overtaken Christianity<sup id="fnref:religion"><a href="#fn:religion" class="footnote">5</a></sup> and the number of actual practicing Christians is on a massive decline (just look at Church attendance).</p>

<p>Commenting on the vote yesterday, Mike Cherry, the policy director of the Federation of Small Businesses, said:</p>

<blockquote>
  <p>The current system can be seen as a great British compromise which allows families to spend time together, employees to work if they wish to, and provides much needed support for smaller retailers within their communities.</p>
</blockquote>

<p>This is absolutely crazy. Families are not spending more time together because of these restrictions and Government should not be restricting free trade on this basis. It also isn’t supporting smaller retailers as large supermarkets have opened small stores on high streets to get around these restrictions. There is already sufficient protections<sup id="fnref:protection"><a href="#fn:protection" class="footnote">6</a></sup> against working on Sundays for workers which would not have changed with this bill. All this has done is penalise workers who wish to work longer hours on a Sunday and consumers (many of whom may also work on a Sunday) from making their purchases.</p>

<p>Consider a nurse, police officer, retail employee, or even a freelancer; if they finish their shift at 6pm on a Sunday, then they can’t go and do a weekly supermarket shop because the size of the store is deemed too big. I often work on a Sunday and then have to dash off to the local supermarket at 3.30pm when I realise I haven’t got any food for the evening. Whilst there are smaller newsagents or even smaller versions of supermarkets such as Tesco Metro, these often charge higher prices or don’t have the same amount of choice.</p>

<p>There is also the issue of online shopping; it is perfectly acceptable for somebody to make a purchase online at 7pm on a Sunday night but it isn’t legal for a retailer to sell them something from a physical building larger than 280m² outside of specific hours.</p>

<p>At a time when the economy needs a boost and there are regular complaints about a lack of jobs, it seems to me utterly stupid that there is a law preventing large retailers from creating more jobs. Whilst a separate issue, I’ve never understood why banks aren’t open after around 1pm on a Saturday; there are plenty of people who need work and it seems to me that opening for more hours would solve this.</p>

<p>Whilst I identify as a Conservative, I’m really more of a Libertarian. I believe the Government should have as little to do with people as possible and this is one of those areas where it really shows; a Government should not be able to stop a shop from selling goods at a certain time because of the size of the building it operates from. Scottish politicians should not be able to prevent shops in England from creating more jobs.</p>

<p>Sunday isn’t special. It is no different from any other day, especially if you are a shift worker or a freelancer that works whenever they can.</p>

<p>It is time for Sunday Trading restrictions to be totally abolished.</p>

<div class="footnotes">
  <ol>
    <li id="fn:politics">
      <p>I have a degree in Politics and have a number of strongly-held views but I don’t like to discuss them on my website which is really to advertise my freelance services. I do tweet about politics regularly though at <a href="https://twitter.com/bendodson">@bendodson</a>. <a href="#fnref:politics" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:mostshops">
      <p>Most shops tend to open 10am-4pm although some will be 11am-5pm or even midday-6pm. <a href="#fnref:mostshops" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:thatcher">
      <p>When I was studying Politics at A-Level, I couldn’t believe that Thatcher’s government had only lost 4 votes in 11 years and one was about the trivial issue of Sunday Trading. <a href="#fnref:thatcher" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:snp">
      <p>Incidentally, I believe this should have been voted on separately to the Enterprise Bill in order to trigger the ‘English Votes for English Laws’ procedure which would have prevented the SNP from having any say over this. <a href="#fnref:snp" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:religion">
      <p>The <a href="http://www.natcen.ac.uk/media/893167/religious-affiliation-british-social-attitudes.pdf">BSA survery in 2014</a> showed 49% identified as “no religion” with Christianity coming in at 42%. <a href="#fnref:religion" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:protection">
      <p>Specifically, staff can “opt out” of working on Sundays even if they had previously agreed in their contract to work on those days. You also can’t be dismissed for not working on a Sunday. The <a href="https://www.gov.uk/sunday-working">Sunday Working</a> page on the gov.uk website has all of the information. <a href="#fnref:protection" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/03/02/board-game-tangents/">The Divide #9 - Board Game Tangents</a></h1>
			
			<time datetime="2016-03-02" pubdate=""><a href="/weblog/2016/03/02/board-game-tangents/">March 02, 2016</a></time>
    	</header>
    	<div>
			<p>Also known as “MithRail: One does not simply ride to Mordor”, the 9th episode of <a href="http://thedivide.co.uk/">The Divide podcast</a> is now available. This week, we discuss board games including such gems as 1861: The Railways of the Russian Empire, Terra Mystica, Takenoko, and Betrayal at the House on the Hill. We also have time to mention Super Hot, Deadpool, the HTC Vive, and some PC games that I’ve supported on Kickstarter!</p>

<p>You can get The Divide from these fine outlets:</p>

<ul>
  <li><a href="https://itunes.apple.com/gb/podcast/the-divide/id1063410638">iTunes</a></li>
  <li><a href="https://overcast.fm/itunes1063410638/the-divide">Overcast</a></li>
  <li><a href="http://thedivide.co.uk/shows/itunes.xml">RSS</a> (for other podcast readers)</li>
  <li><a href="http://thedivide.co.uk/">The Divide website</a></li>
</ul>

<p>Don’t forget to leave a review on iTunes and follow us on Twitter via <a href="http://twitter.com/PodcastDivide">@PodcastDivide</a>.</p>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/26/storefront-additions-skcloudservicecontroller-to-country-code/">Storefront Additions: A simple way to convert SKCloudServiceController store identifiers into country codes</a></h1>
			
			<time datetime="2016-02-26" pubdate=""><a href="/weblog/2016/02/26/storefront-additions-skcloudservicecontroller-to-country-code/">February 26, 2016</a></time>
    	</header>
    	<div>
			<p>In <a href="https://bendodson.com/weblog/2016/02/23/details-on-ios-9-3-media-library-additions/">my article a few days ago</a>, I noted that <code>SKCloudServiceController</code> would give you a storefront identifier but that there was very little information about how to use that identifier when using the iTunes Search API. As it turns out, Apple do provide a list of store identifiers with their respective ISO country codes on their <a href="https://affiliate.itunes.apple.com/resources/documentation/linking-to-the-itunes-music-store/">iTunes Affiliate Links website</a> - a big thank you to <a href="https://twitter.com/loretoparisi">Loreto Parisi</a> for directing me to it.</p>

<p>In order to make things a bit easier for other developers, <a href="https://github.com/bendodson/storefront-assistant">I’ve put together a simple class and plist file</a> that will automatically return a country code for the current user’s store. It’s incredibly simple:</p>

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">StorefrontAssistant</span><span class="p">.</span><span class="n">countryCode</span> <span class="p">{</span> <span class="p">(</span><span class="n">countryCode</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">if</span> <span class="k">let</span> <span class="n">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">&quot;Error: \(error)&quot;</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="k">let</span> <span class="n">countryCode</span> <span class="o">=</span> <span class="n">countryCode</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">&quot;Country code: \(countryCode)&quot;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>Storefront Assistant will automatically request permissions to access the Media Library and then fetch the current storefront identifier for the logged in user. If there are any issues (i.e. permissions denied, no connectivity, country code can’t be found) then an NSError will be returned.</p>

<p>Once you have the country code, you can then use the <a href="https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/">iTunes Search API</a> to search for tracks in the correct country; these can then be used with <code>MPMusicPlayerController</code> for immediate playback or <code>MPMediaLibrary</code> for saving to the user’s Media Library.</p>

<p>The full code is <a href="https://github.com/bendodson/storefront-assistant">available on GitHub</a>.</p>

<p><strong>Update, 10th Mar 2016:</strong> <a href="https://twitter.com/loretoparisi">Loreto Parisi</a> has put together some code in order to provide this list as a JSON file instead of a plist; he also has a Node JS implementation to scrape this information regularly from the iTunes Affiliate Link Website. <a href="https://github.com/loretoparisi/itunes-countrycode-node">Check it out on GitHub</a>.</p>

<p><strong>Update, 31st Mar 2016:</strong> Thanks to <a href="https://twitter.com/AbrasMateus">Matt Abras</a> it turns out that the above code isn’t necessary; you can just use the undocumented <code>s=143444</code> instead of <code>country=gb</code> when using the <a href="https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/">iTunes Search API</a>.</p>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/23/details-on-ios-9-3-media-library-additions/">Details on the iOS 9.3 Media Library additions</a></h1>
			
			<time datetime="2016-02-23" pubdate=""><a href="/weblog/2016/02/23/details-on-ios-9-3-media-library-additions/">February 23, 2016</a></time>
    	</header>
    	<div>
			<p><strong>UPDATE: Thanks to my raising this privacy concern, <a href="https://bendodson.com/weblog/2016/08/02/media-library-privacy-flaw-fixed-in-ios-10/">Apple have resolved this issue as of iOS 10</a>. I’ve left the old post below for posterity.</strong></p>

<p>Due to my <a href="https://bendodson.com/weblog/2016/01/13/your-music-library-is-a-security-and-privacy-risk-on-ios/">article on music library security on iOS</a>, I’ve found myself in the position of being misquoted or misunderstood on sites such as <a href="http://appleinsider.com/articles/16/02/18/inside-ios-93-apple-will-allow-third-party-apps-to-add-music-to-your-icloud-music-library">AppleInsider</a> (mainly in the comments) with regards to the new media library APIs in iOS 9.3. This article is intended to clear up some misunderstandings that people have about these new APIs.</p>

<p>In iOS 9.3, there are several additions to the music library. Indeed, it is the first item listed in the <a href="https://developer.apple.com/library/prerelease/ios/releasenotes/General/WhatsNewIniOS/Articles/iOS9_3.html#//apple_ref/doc/uid/TP40016661-SW1">What’s New in iOS 9.3</a> developer document:</p>

<blockquote>
  <p><em>New methods in the Media Player and StoreKit frameworks let you add an Apple Music track to the music library and play it. First, use the SKCloudServiceController API to determine the current capabilities, such as if the device allows playback of Apple Music catalog tracks and the addition of tracks to the library. Then, you can use the MPMediaLibrary method addItemWithProductID:completionHandler: to add a track to the library and the MPMusicPlayerController method setQueueWithStoreIDs: to play a track.</em></p>
</blockquote>

<p>Firstly, the StoreKit framework has been updated to include an <code>SKCloudServiceController</code> which basically gives an app the opportunity to request access to a user’s media library and to check if they have the ability to stream Apple Music tracks and / or add those tracks to their iCloud Music library.</p>

<p>Next, <code>MPMusicPlayerController</code> has been updated with a new method named <code>setQueueWithStoreIDs</code> which allows you to basically hand over an array of Apple Music identifiers and have those play instantly in the Music app without leaving your own app. Interestingly, this allows you to Rickroll someone in just a few lines of code:</p>

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">func</span> <span class="nf">play</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">trackID</span> <span class="o">=</span> <span class="s">&quot;255991760&quot;</span> <span class="c1">// use 302053341 in USA, 255991760 in UK</span>
    <span class="k">let</span> <span class="n">controller</span> <span class="o">=</span> <span class="bp">MPMusicPlayerController</span><span class="p">()</span>
    <span class="n">controller</span><span class="p">.</span><span class="n">setQueueWithStoreIDs</span><span class="p">([</span><span class="n">trackID</span><span class="p">])</span>
    <span class="n">controller</span><span class="p">.</span><span class="n">play</span><span class="p">()</span>
<span class="p">}</span></code></pre></div>

<p>This API, whilst interesting, has a few issues; the identifiers for music tracks are different for each country so a US track will not play on a UK Apple Music account<sup id="fnref:storeidentifier"><a href="#fn:storeidentifier" class="footnote">1</a></sup>. There is also no error handling so it’ll just silently fail if you give it an incorrect identifier or one from the wrong store.</p>

<p>The final new addition is to <code>MPMediaLibrary</code> and is a method named <code>addItemWithProductID:completionHandler:</code>. This allows you to add an Apple Music track to the user’s library as long as they gave permission via the <code>SKCloudServiceController</code> and they have a valid Apple Music account. I had some issues getting this working on an iPhone 5c but it worked just fine on an iPad Pro leading me to think this may be an API limited to 64-bit devices (although this is still in beta so that may change). However, the API does not allow you to add MP3s to your library or import Spotify tracks or anything like that; it is just a way to add Apple Music tracks to your library. Why is that useful? The scenario I envision is that it is for apps like Shazam that identify music and then traditionally give you a link to go and see it in Apple Music or the iTunes Store. With this new API, those apps can now add a button such as “add this track to your library?” which will allow them to automatically add the Apple Music track to the media library.</p>

<p>The new APIs do not do any of the following things:</p>

<ul>
  <li>They do not allow apps to add music to your library if you are not using Apple Music</li>
  <li>They do not allow apps to add music to your library that is not available on Apple Music</li>
  <li>They do not allow apps to delete music from your library</li>
  <li>They do not allow apps to edit metadata on any music in your library (i.e. changing title, artist, genre, rating, artwork)</li>
</ul>

<p>Crucially, and linking this back to my previous article, <strong>this new permissions system is only for the new “add Apple Music tracks to your library API”; apps do not require permission to scan through your library</strong>. I’m still hopeful this will be addressed as at present the ‘Privacy’ settings screen in iOS 9.3 is incredibly misleading:</p>

<p><img src="https://bendodson.s3.amazonaws.com/weblog/2016/music-library-privacy.jpg" width="800" height="533" /></p>

<p>I take serious issue with the phrase <em>“Apps that have requested access to your media library will appear here”</em> because it makes it sound like apps require permission to access your library which is just not true. My <a href="https://dodoapps.io/music-tracker/">Music Tracker</a> app continues to work unimpeded on iOS 9.3 with no need to request access and, as demonstrated above, you can start playing streamed music in the Music app without authorization. This is all true as of iOS 9.3 beta 4 so hopefully it may get resolved before the final version of iOS 9.3 is released next month.</p>

<p>(<strong>Update:</strong> This was not resolved in the public version of iOS 9.3)</p>

<p>If you have any queries about how these new APIs work or how they will or won’t affect your media library, <a href="https://bendodson.com/contact/">please feel free to contact me</a>.</p>

<div class="footnotes">
  <ol>
    <li id="fn:storeidentifier">
      <strike>There is a new API to give you a storefront identifier (mine is "143444,29") but I'm not sure how you translate to a single language like "gb" for use with the iTunes Search API - if anyone can shed some light on that, please let me know!</strike>
      <p><strong>Update, 10th Mar 2016:</strong> Thanks to <a href="https://twitter.com/loretoparisi">Loreto Parisi</a> for making me aware of the <a href="https://affiliate.itunes.apple.com/resources/documentation/linking-to-the-itunes-music-store/">iTunes Affiliate Link website</a> which contains a full list of the store identifiers and their respective ISO country codes which can be used with the iTunes Search API. I’ve <a href="https://bendodson.com/weblog/2016/02/26/storefront-additions-skcloudservicecontroller-to-country-code/">put together a simple class</a> to take care of this automatically. <br /><strong>Update, 31st Mar 2016:</strong> Thanks to <a href="https://twitter.com/AbrasMateus">Matt Abras</a> it turns out that the above code isn’t necessary; you can just use the undocumented <code>s=143444</code> instead of <code>country=gb</code> when using the <a href="https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/">iTunes Search API</a>. <a href="#fnref:storeidentifier" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/17/divide-8-drunkstarter-crowdfunding/">The Divide #8 - Drunkstarter: A discussion on crowdfunding</a></h1>
			
			<time datetime="2016-02-17" pubdate=""><a href="/weblog/2016/02/17/divide-8-drunkstarter-crowdfunding/">February 17, 2016</a></time>
    	</header>
    	<div>
			<p>The 8th episode of <a href="http://thedivide.co.uk/">The Divide podcast</a> is now available in which we discuss crowdfunding<sup id="fnref:crowdfunding"><a href="#fn:crowdfunding" class="footnote">1</a></sup> along with some of our favourite Kickstarter campaigns. We also check in on Mass Effect 4 pricing, dissect the iPhone <em>Code 53</em> issue, and wonder if Nicolas Cage movies can fix online dating.</p>

<p>You can get The Divide from these fine outlets:</p>

<ul>
  <li><a href="https://itunes.apple.com/gb/podcast/the-divide/id1063410638">iTunes</a></li>
  <li><a href="https://overcast.fm/itunes1063410638/the-divide">Overcast</a></li>
  <li><a href="http://thedivide.co.uk/shows/itunes.xml">RSS</a> (for other podcast readers)</li>
  <li><a href="http://thedivide.co.uk/">The Divide website</a></li>
</ul>

<p>Don’t forget to leave a review on iTunes and follow us on Twitter via <a href="http://twitter.com/PodcastDivide">@PodcastDivide</a>.</p>

<div class="footnotes">
  <ol>
    <li id="fn:crowdfunding">
      <p>Chris hasn’t tried it, John loves it, and I hate it. <a href="#fnref:crowdfunding" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/16/music-tracker-and-pocket-rocket-1-1/">Music Tracker v1.1 and Pocket Rocket v1.1 Released</a></h1>
			
			<time datetime="2016-02-16" pubdate=""><a href="/weblog/2016/02/16/music-tracker-and-pocket-rocket-1-1/">February 16, 2016</a></time>
    	</header>
    	<div>
			<p>Last week, version 1.1 of both <a href="https://dodoapps.io/music-tracker/">Music Tracker</a> and <a href="https://dodoapps.io/pocket-rocket/">Pocket Rocket</a> were released in the App Store.</p>

<p><img src="https://bendodson.s3.amazonaws.com/dodo/music-tracker-ipad.jpg" width="800" height="531" /></p>

<p>The main new feature for Music Tracker v1.1 is native support for iPad. This includes not only the iPad Air and iPad Pro, but also all of the various split-screen modes that can be applied in both portrait and landscape. This release also includes landscape support for the iPhone. There were also a few minor bug fixes.</p>

<p>I’m aware that a few people with large libraries (anything over ~25000 tracks) are experiencing some performance issues which can cause the automatic tracking to fail; a new update is under development to fix that. If you have a large library and would like to test that release, please <a href="https://bendodson.com/contact/">let me know</a>.</p>

<p><img src="https://bendodson.s3.amazonaws.com/dodo/pocket-rocket-settings.jpg" width="800" height="550" /></p>

<p>Pocket Rocket v1.1 adds a few features that were requested from existing customers. These include the ability to see the total number of unread articles on the app icon and using Background App Refresh to keep that count up-to-date. There are also a few bug fixes (including a big one that crashed the app with certain query strings in URLs) and a 3D Touch Quick Action (for iPhone 6s) so you can see when the articles were last updated.</p>

<p>If there are any features you’d like to see added to either Pocket Rocket or Music Tracker, please <a href="https://bendodson.com/contact">get in touch</a>.</p>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/05/deleting-all-nsuserdefaults-with-swift/">Deleting all NSUserDefaults with Swift</a></h1>
			
			<time datetime="2016-02-05" pubdate=""><a href="/weblog/2016/02/05/deleting-all-nsuserdefaults-with-swift/">February 05, 2016</a></time>
    	</header>
    	<div>
			<p>NSUserDefaults is likely one of the most used APIs on iOS providing a quick and easy way to store basic configuration and settings. However, these can quickly mount up and you’ll typically end up with something like this in your project within a logout method:</p>

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">let</span> <span class="n">defaults</span> <span class="o">=</span> <span class="bp">NSUserDefaults</span><span class="p">.</span><span class="n">standardUserDefaults</span><span class="p">()</span>
<span class="n">defaults</span><span class="p">.</span><span class="n">removeObjectForKey</span><span class="p">(</span><span class="s">&quot;Username&quot;</span><span class="p">)</span>
<span class="n">defaults</span><span class="p">.</span><span class="n">removeObjectForKey</span><span class="p">(</span><span class="s">&quot;Token&quot;</span><span class="p">)</span>
<span class="n">defaults</span><span class="p">.</span><span class="n">removeObjectForKey</span><span class="p">(</span><span class="s">&quot;SomeSetting&quot;</span><span class="p">)</span>
<span class="n">defaults</span><span class="p">.</span><span class="n">removeObjectForKey</span><span class="p">(</span><span class="s">&quot;FavouriteArtist&quot;</span><span class="p">)</span>
<span class="n">defaults</span><span class="p">.</span><span class="n">synchronize</span><span class="p">()</span></code></pre></div>

<p><strong>(Note: you should never store secure information like a password or API token in NSUserDefaults; that’s what the Keychain is for. You should probably also use static constants in a config file for your keys but this will do for a demonstration)</strong></p>

<p>The problem with something like this is that you have to remember to go and add an extra <code>removeObjectForKey</code> whenever you add a new setting and this can be easily forgotten and lead to settings being shared between different user accounts. I’ve definitely been guilty of doing this in the past and, whilst working on an update to <a href="https://dodoapps.io/pocket-rocket/">Pocket Rocket</a>, I found that this can be much simpler:</p>

<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="bp">NSUserDefaults</span><span class="p">.</span><span class="n">standardUserDefaults</span><span class="p">().</span><span class="n">removePersistentDomainForName</span><span class="p">(</span><span class="bp">NSBundle</span><span class="p">.</span><span class="n">mainBundle</span><span class="p">().</span><span class="n">bundleIdentifier</span><span class="o">!</span><span class="p">)</span>
<span class="bp">NSUserDefaults</span><span class="p">.</span><span class="n">standardUserDefaults</span><span class="p">().</span><span class="n">synchronize</span><span class="p">()</span></code></pre></div>

<p>This will clear all of the NSUserDefaults that have been set by your code leaving you with a fresh slate just as if the app had been deleted and reinstalled. You don’t need to update your logout method whenever a new setting gets added and you can be sure that everything is being reset in full.</p>

<p><strong>Update:</strong> a few people have asked why I perform <code>NSUserDefaults.standardUserDefaults().synchronize()</code> as this should happen automatically. The key word here is <em>should</em>; since iOS 7, NSUserDefaults do not get written to disk as frequently as previously (i.e. when going into the background). With the addition of things like watch extensions, widgets, and keyboards that can all access a shared NSUserDefaults, I find it is always best to perform a sync (which ensures the data is written to disk immediately) as then none of the other aspects of your app or extensions will access invalid data. It doesn’t add any significant performance overhead in my experience but can save you from embarrassing bugs.</p>

		</div>
	</article>
    
	
</section>


<section id="pagination">
     
    	<a href="/weblog/page/5/" title="Previous Page" class="pagination-previous">&laquo; Older Entries</a>
     
	
    
      
      	<a href="/weblog/page/3/" title="Next Page" class="pagination-next">Newer Entries &raquo; </a>
      
    
</section>

		
		<footer>
			<p>I perform all freelance work through my company <strong>Dodo Apps Ltd</strong> (07856552) registered at The Bristol Office, 2nd Floor, 5 High Street, Westbury on Trym, Bristol, England, BS9 3BY</p>
		</footer>

	</div>


</body>
</html>
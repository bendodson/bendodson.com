<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	
	

	


	<link href='https://fonts.googleapis.com/css?family=PT+Sans+Caption:400,700' rel='stylesheet' type='text/css'>
	<link rel="alternate" type="application/rss+xml" title="Ben Dodson, iOS Developer" href="https://bendodson.com/rss.xml" />
	<link rel="stylesheet" href="/styles-2022-12-05.css" />
	<link rel="stylesheet" href="/highlight-2018-02-23.css" />
	<link rel="icon" href="https://bendodson.s3.amazonaws.com/bendodson.com/favicon.ico">
	<link rel="apple-touch-icon" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-iphone.png">
	<link rel="apple-touch-icon" sizes="76x76" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-ipad.png">
	<link rel="apple-touch-icon" sizes="120x120" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-iphone-retina.png">
	<link rel="apple-touch-icon" sizes="152x152" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-ipad-retina.png">
	<link rel="apple-touch-icon" sizes="180x180" href="https://bendodson.s3.amazonaws.com/bendodson.com/touch-icon-ipad-retina.png">
	<title>Ben Dodson's Blog &mdash; Freelance Swift and Apple Platforms Developer</title>
</head>
<body>

	<div id="wrapper">

		<header>
			<hgroup>
				<h1><a href="/">Ben Dodson</a></h1>
				<h2>Freelance iOS, macOS, Apple Watch, and Apple TV Developer</h2>
			</hgroup>
			<nav>
				<ul>
					<li><a href="/">Home</a></li><li><a href="/weblog/">Blog</a></li><li><a href="/about/">About</a></li><li><a href="/clients/">Portfolio</a></li><li><a href="/apps/">My Apps</a></li><li><a href="/projects/">Projects</a></li><li><a href="/contact/">Contact</a></li>
				</ul>
				<div class="divider"></div>
			</nav>
		</header>

		<section id="posts">

	
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/03/02/board-game-tangents/">The Divide #9 - Board Game Tangents</a></h1>
			
			<time datetime="2016-03-02" pubdate=""><a href="/weblog/2016/03/02/board-game-tangents/">March 02, 2016</a></time>
    	</header>
    	<div>
			<p>Also known as “MithRail: One does not simply ride to Mordor”, the 9th episode of <a href="http://thedivide.co.uk/">The Divide podcast</a> is now available. This week, we discuss board games including such gems as 1861: The Railways of the Russian Empire, Terra Mystica, Takenoko, and Betrayal at the House on the Hill. We also have time to mention Super Hot, Deadpool, the HTC Vive, and some PC games that I’ve supported on Kickstarter!</p>

<p>You can get The Divide from these fine outlets:</p>

<ul>
  <li><a href="https://itunes.apple.com/gb/podcast/the-divide/id1063410638">iTunes</a></li>
  <li><a href="https://overcast.fm/itunes1063410638/the-divide">Overcast</a></li>
  <li><a href="http://thedivide.co.uk/shows/itunes.xml">RSS</a> (for other podcast readers)</li>
  <li><a href="http://thedivide.co.uk/">The Divide website</a></li>
</ul>

<p>Don’t forget to leave a review on iTunes and follow us on Twitter via <a href="http://twitter.com/PodcastDivide">@PodcastDivide</a>.</p>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/26/storefront-additions-skcloudservicecontroller-to-country-code/">Storefront Additions: A simple way to convert SKCloudServiceController store identifiers into country codes</a></h1>
			
			<time datetime="2016-02-26" pubdate=""><a href="/weblog/2016/02/26/storefront-additions-skcloudservicecontroller-to-country-code/">February 26, 2016</a></time>
    	</header>
    	<div>
			<p>In <a href="https://bendodson.com/weblog/2016/02/23/details-on-ios-9-3-media-library-additions/">my article a few days ago</a>, I noted that <code class="language-plaintext highlighter-rouge">SKCloudServiceController</code> would give you a storefront identifier but that there was very little information about how to use that identifier when using the iTunes Search API. As it turns out, Apple do provide a list of store identifiers with their respective ISO country codes on their <a href="https://affiliate.itunes.apple.com/resources/documentation/linking-to-the-itunes-music-store/">iTunes Affiliate Links website</a> - a big thank you to <a href="https://twitter.com/loretoparisi">Loreto Parisi</a> for directing me to it.</p>

<p>In order to make things a bit easier for other developers, <a href="https://github.com/bendodson/storefront-assistant">I’ve put together a simple class and plist file</a> that will automatically return a country code for the current user’s store. It’s incredibly simple:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kt">StorefrontAssistant</span><span class="o">.</span><span class="n">countryCode</span> <span class="p">{</span> <span class="p">(</span><span class="n">countryCode</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
        <span class="kt">NSLog</span><span class="p">(</span><span class="s">"Error: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">countryCode</span> <span class="o">=</span> <span class="n">countryCode</span> <span class="p">{</span>
        <span class="kt">NSLog</span><span class="p">(</span><span class="s">"Country code: </span><span class="se">\(</span><span class="n">countryCode</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Storefront Assistant will automatically request permissions to access the Media Library and then fetch the current storefront identifier for the logged in user. If there are any issues (i.e. permissions denied, no connectivity, country code can’t be found) then an NSError will be returned.</p>

<p>Once you have the country code, you can then use the <a href="https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/">iTunes Search API</a> to search for tracks in the correct country; these can then be used with <code class="language-plaintext highlighter-rouge">MPMusicPlayerController</code> for immediate playback or <code class="language-plaintext highlighter-rouge">MPMediaLibrary</code> for saving to the user’s Media Library.</p>

<p>The full code is <a href="https://github.com/bendodson/storefront-assistant">available on GitHub</a>.</p>

<p><strong>Update, 10th Mar 2016:</strong> <a href="https://twitter.com/loretoparisi">Loreto Parisi</a> has put together some code in order to provide this list as a JSON file instead of a plist; he also has a Node JS implementation to scrape this information regularly from the iTunes Affiliate Link Website. <a href="https://github.com/loretoparisi/itunes-countrycode-node">Check it out on GitHub</a>.</p>

<p><strong>Update, 31st Mar 2016:</strong> Thanks to <a href="https://twitter.com/AbrasMateus">Matt Abras</a> it turns out that the above code isn’t necessary; you can just use the undocumented <code class="language-plaintext highlighter-rouge">s=143444</code> instead of <code class="language-plaintext highlighter-rouge">country=gb</code> when using the <a href="https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/">iTunes Search API</a>.</p>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/23/details-on-ios-9-3-media-library-additions/">Details on the iOS 9.3 Media Library additions</a></h1>
			
			<time datetime="2016-02-23" pubdate=""><a href="/weblog/2016/02/23/details-on-ios-9-3-media-library-additions/">February 23, 2016</a></time>
    	</header>
    	<div>
			<p><strong>UPDATE: Thanks to my raising this privacy concern, <a href="https://bendodson.com/weblog/2016/08/02/media-library-privacy-flaw-fixed-in-ios-10/">Apple have resolved this issue as of iOS 10</a>. I’ve left the old post below for posterity.</strong></p>

<p>Due to my <a href="https://bendodson.com/weblog/2016/01/13/your-music-library-is-a-security-and-privacy-risk-on-ios/">article on music library security on iOS</a>, I’ve found myself in the position of being misquoted or misunderstood on sites such as <a href="http://appleinsider.com/articles/16/02/18/inside-ios-93-apple-will-allow-third-party-apps-to-add-music-to-your-icloud-music-library">AppleInsider</a> (mainly in the comments) with regards to the new media library APIs in iOS 9.3. This article is intended to clear up some misunderstandings that people have about these new APIs.</p>

<p>In iOS 9.3, there are several additions to the music library. Indeed, it is the first item listed in the <a href="https://developer.apple.com/library/prerelease/ios/releasenotes/General/WhatsNewIniOS/Articles/iOS9_3.html#//apple_ref/doc/uid/TP40016661-SW1">What’s New in iOS 9.3</a> developer document:</p>

<blockquote>
  <p><em>New methods in the Media Player and StoreKit frameworks let you add an Apple Music track to the music library and play it. First, use the SKCloudServiceController API to determine the current capabilities, such as if the device allows playback of Apple Music catalog tracks and the addition of tracks to the library. Then, you can use the MPMediaLibrary method addItemWithProductID:completionHandler: to add a track to the library and the MPMusicPlayerController method setQueueWithStoreIDs: to play a track.</em></p>
</blockquote>

<p>Firstly, the StoreKit framework has been updated to include an <code class="language-plaintext highlighter-rouge">SKCloudServiceController</code> which basically gives an app the opportunity to request access to a user’s media library and to check if they have the ability to stream Apple Music tracks and / or add those tracks to their iCloud Music library.</p>

<p>Next, <code class="language-plaintext highlighter-rouge">MPMusicPlayerController</code> has been updated with a new method named <code class="language-plaintext highlighter-rouge">setQueueWithStoreIDs</code> which allows you to basically hand over an array of Apple Music identifiers and have those play instantly in the Music app without leaving your own app. Interestingly, this allows you to Rickroll someone in just a few lines of code:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">play</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">trackID</span> <span class="o">=</span> <span class="s">"255991760"</span> <span class="c1">// use 302053341 in USA, 255991760 in UK</span>
    <span class="k">let</span> <span class="nv">controller</span> <span class="o">=</span> <span class="kt">MPMusicPlayerController</span><span class="p">()</span>
    <span class="n">controller</span><span class="o">.</span><span class="nf">setQueueWithStoreIDs</span><span class="p">([</span><span class="n">trackID</span><span class="p">])</span>
    <span class="n">controller</span><span class="o">.</span><span class="nf">play</span><span class="p">()</span>
<span class="p">}</span></code></pre></figure>

<p>This API, whilst interesting, has a few issues; the identifiers for music tracks are different for each country so a US track will not play on a UK Apple Music account<sup id="fnref:storeidentifier" role="doc-noteref"><a href="#fn:storeidentifier" class="footnote" rel="footnote">1</a></sup>. There is also no error handling so it’ll just silently fail if you give it an incorrect identifier or one from the wrong store.</p>

<p>The final new addition is to <code class="language-plaintext highlighter-rouge">MPMediaLibrary</code> and is a method named <code class="language-plaintext highlighter-rouge">addItemWithProductID:completionHandler:</code>. This allows you to add an Apple Music track to the user’s library as long as they gave permission via the <code class="language-plaintext highlighter-rouge">SKCloudServiceController</code> and they have a valid Apple Music account. I had some issues getting this working on an iPhone 5c but it worked just fine on an iPad Pro leading me to think this may be an API limited to 64-bit devices (although this is still in beta so that may change). However, the API does not allow you to add MP3s to your library or import Spotify tracks or anything like that; it is just a way to add Apple Music tracks to your library. Why is that useful? The scenario I envision is that it is for apps like Shazam that identify music and then traditionally give you a link to go and see it in Apple Music or the iTunes Store. With this new API, those apps can now add a button such as “add this track to your library?” which will allow them to automatically add the Apple Music track to the media library.</p>

<p>The new APIs do not do any of the following things:</p>

<ul>
  <li>They do not allow apps to add music to your library if you are not using Apple Music</li>
  <li>They do not allow apps to add music to your library that is not available on Apple Music</li>
  <li>They do not allow apps to delete music from your library</li>
  <li>They do not allow apps to edit metadata on any music in your library (i.e. changing title, artist, genre, rating, artwork)</li>
</ul>

<p>Crucially, and linking this back to my previous article, <strong>this new permissions system is only for the new “add Apple Music tracks to your library API”; apps do not require permission to scan through your library</strong>. I’m still hopeful this will be addressed as at present the ‘Privacy’ settings screen in iOS 9.3 is incredibly misleading:</p>

<p><img src="https://bendodson.s3.amazonaws.com/weblog/2016/music-library-privacy.jpg" width="800" height="533" /></p>

<p>I take serious issue with the phrase <em>“Apps that have requested access to your media library will appear here”</em> because it makes it sound like apps require permission to access your library which is just not true. My <a href="https://dodoapps.io/music-tracker/">Music Tracker</a> app continues to work unimpeded on iOS 9.3 with no need to request access and, as demonstrated above, you can start playing streamed music in the Music app without authorization. This is all true as of iOS 9.3 beta 4 so hopefully it may get resolved before the final version of iOS 9.3 is released next month.</p>

<p>(<strong>Update:</strong> This was not resolved in the public version of iOS 9.3)</p>

<p>If you have any queries about how these new APIs work or how they will or won’t affect your media library, <a href="https://bendodson.com/contact/">please feel free to contact me</a>.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:storeidentifier" role="doc-endnote">
      <strike>There is a new API to give you a storefront identifier (mine is "143444,29") but I'm not sure how you translate to a single language like "gb" for use with the iTunes Search API - if anyone can shed some light on that, please let me know!</strike>
      <p><strong>Update, 10th Mar 2016:</strong> Thanks to <a href="https://twitter.com/loretoparisi">Loreto Parisi</a> for making me aware of the <a href="https://affiliate.itunes.apple.com/resources/documentation/linking-to-the-itunes-music-store/">iTunes Affiliate Link website</a> which contains a full list of the store identifiers and their respective ISO country codes which can be used with the iTunes Search API. I’ve <a href="https://bendodson.com/weblog/2016/02/26/storefront-additions-skcloudservicecontroller-to-country-code/">put together a simple class</a> to take care of this automatically. <br /><strong>Update, 31st Mar 2016:</strong> Thanks to <a href="https://twitter.com/AbrasMateus">Matt Abras</a> it turns out that the above code isn’t necessary; you can just use the undocumented <code class="language-plaintext highlighter-rouge">s=143444</code> instead of <code class="language-plaintext highlighter-rouge">country=gb</code> when using the <a href="https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/">iTunes Search API</a>. <a href="#fnref:storeidentifier" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/17/divide-8-drunkstarter-crowdfunding/">The Divide #8 - Drunkstarter: A discussion on crowdfunding</a></h1>
			
			<time datetime="2016-02-17" pubdate=""><a href="/weblog/2016/02/17/divide-8-drunkstarter-crowdfunding/">February 17, 2016</a></time>
    	</header>
    	<div>
			<p>The 8th episode of <a href="http://thedivide.co.uk/">The Divide podcast</a> is now available in which we discuss crowdfunding<sup id="fnref:crowdfunding" role="doc-noteref"><a href="#fn:crowdfunding" class="footnote" rel="footnote">1</a></sup> along with some of our favourite Kickstarter campaigns. We also check in on Mass Effect 4 pricing, dissect the iPhone <em>Code 53</em> issue, and wonder if Nicolas Cage movies can fix online dating.</p>

<p>You can get The Divide from these fine outlets:</p>

<ul>
  <li><a href="https://itunes.apple.com/gb/podcast/the-divide/id1063410638">iTunes</a></li>
  <li><a href="https://overcast.fm/itunes1063410638/the-divide">Overcast</a></li>
  <li><a href="http://thedivide.co.uk/shows/itunes.xml">RSS</a> (for other podcast readers)</li>
  <li><a href="http://thedivide.co.uk/">The Divide website</a></li>
</ul>

<p>Don’t forget to leave a review on iTunes and follow us on Twitter via <a href="http://twitter.com/PodcastDivide">@PodcastDivide</a>.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:crowdfunding" role="doc-endnote">
      <p>Chris hasn’t tried it, John loves it, and I hate it. <a href="#fnref:crowdfunding" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/16/music-tracker-and-pocket-rocket-1-1/">Music Tracker v1.1 and Pocket Rocket v1.1 Released</a></h1>
			
			<time datetime="2016-02-16" pubdate=""><a href="/weblog/2016/02/16/music-tracker-and-pocket-rocket-1-1/">February 16, 2016</a></time>
    	</header>
    	<div>
			<p>Last week, version 1.1 of both <a href="https://dodoapps.io/music-tracker/">Music Tracker</a> and <a href="https://dodoapps.io/pocket-rocket/">Pocket Rocket</a> were released in the App Store.</p>

<p><img src="https://bendodson.s3.amazonaws.com/dodo/music-tracker-ipad.jpg" width="800" height="531" /></p>

<p>The main new feature for Music Tracker v1.1 is native support for iPad. This includes not only the iPad Air and iPad Pro, but also all of the various split-screen modes that can be applied in both portrait and landscape. This release also includes landscape support for the iPhone. There were also a few minor bug fixes.</p>

<p>I’m aware that a few people with large libraries (anything over ~25000 tracks) are experiencing some performance issues which can cause the automatic tracking to fail; a new update is under development to fix that. If you have a large library and would like to test that release, please <a href="https://bendodson.com/contact/">let me know</a>.</p>

<p><img src="https://bendodson.s3.amazonaws.com/dodo/pocket-rocket-settings.jpg" width="800" height="550" /></p>

<p>Pocket Rocket v1.1 adds a few features that were requested from existing customers. These include the ability to see the total number of unread articles on the app icon and using Background App Refresh to keep that count up-to-date. There are also a few bug fixes (including a big one that crashed the app with certain query strings in URLs) and a 3D Touch Quick Action (for iPhone 6s) so you can see when the articles were last updated.</p>

<p>If there are any features you’d like to see added to either Pocket Rocket or Music Tracker, please <a href="https://bendodson.com/contact">get in touch</a>.</p>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/05/deleting-all-nsuserdefaults-with-swift/">Deleting all NSUserDefaults with Swift</a></h1>
			
			<time datetime="2016-02-05" pubdate=""><a href="/weblog/2016/02/05/deleting-all-nsuserdefaults-with-swift/">February 05, 2016</a></time>
    	</header>
    	<div>
			<p>NSUserDefaults is likely one of the most used APIs on iOS providing a quick and easy way to store basic configuration and settings. However, these can quickly mount up and you’ll typically end up with something like this in your project within a logout method:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">let</span> <span class="nv">defaults</span> <span class="o">=</span> <span class="kt">NSUserDefaults</span><span class="o">.</span><span class="nf">standardUserDefaults</span><span class="p">()</span>
<span class="n">defaults</span><span class="o">.</span><span class="nf">removeObjectForKey</span><span class="p">(</span><span class="s">"Username"</span><span class="p">)</span>
<span class="n">defaults</span><span class="o">.</span><span class="nf">removeObjectForKey</span><span class="p">(</span><span class="s">"Token"</span><span class="p">)</span>
<span class="n">defaults</span><span class="o">.</span><span class="nf">removeObjectForKey</span><span class="p">(</span><span class="s">"SomeSetting"</span><span class="p">)</span>
<span class="n">defaults</span><span class="o">.</span><span class="nf">removeObjectForKey</span><span class="p">(</span><span class="s">"FavouriteArtist"</span><span class="p">)</span>
<span class="n">defaults</span><span class="o">.</span><span class="nf">synchronize</span><span class="p">()</span></code></pre></figure>

<p><strong>(Note: you should never store secure information like a password or API token in NSUserDefaults; that’s what the Keychain is for. You should probably also use static constants in a config file for your keys but this will do for a demonstration)</strong></p>

<p>The problem with something like this is that you have to remember to go and add an extra <code class="language-plaintext highlighter-rouge">removeObjectForKey</code> whenever you add a new setting and this can be easily forgotten and lead to settings being shared between different user accounts. I’ve definitely been guilty of doing this in the past and, whilst working on an update to <a href="https://dodoapps.io/pocket-rocket/">Pocket Rocket</a>, I found that this can be much simpler:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kt">NSUserDefaults</span><span class="o">.</span><span class="nf">standardUserDefaults</span><span class="p">()</span><span class="o">.</span><span class="nf">removePersistentDomainForName</span><span class="p">(</span><span class="kt">NSBundle</span><span class="o">.</span><span class="nf">mainBundle</span><span class="p">()</span><span class="o">.</span><span class="n">bundleIdentifier</span><span class="o">!</span><span class="p">)</span>
<span class="kt">NSUserDefaults</span><span class="o">.</span><span class="nf">standardUserDefaults</span><span class="p">()</span><span class="o">.</span><span class="nf">synchronize</span><span class="p">()</span></code></pre></figure>

<p>This will clear all of the NSUserDefaults that have been set by your code leaving you with a fresh slate just as if the app had been deleted and reinstalled. You don’t need to update your logout method whenever a new setting gets added and you can be sure that everything is being reset in full.</p>

<p><strong>Update:</strong> a few people have asked why I perform <code class="language-plaintext highlighter-rouge">NSUserDefaults.standardUserDefaults().synchronize()</code> as this should happen automatically. The key word here is <em>should</em>; since iOS 7, NSUserDefaults do not get written to disk as frequently as previously (i.e. when going into the background). With the addition of things like watch extensions, widgets, and keyboards that can all access a shared NSUserDefaults, I find it is always best to perform a sync (which ensures the data is written to disk immediately) as then none of the other aspects of your app or extensions will access invalid data. It doesn’t add any significant performance overhead in my experience but can save you from embarrassing bugs.</p>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/02/02/calm-radio-for-ios/">Calm Radio for iOS</a></h1>
			
			<time datetime="2016-02-02" pubdate=""><a href="/weblog/2016/02/02/calm-radio-for-ios/">February 02, 2016</a></time>
    	</header>
    	<div>
			<p>I’m happy to announce that the new iOS app I built for <a href="https://itunes.apple.com/us/app/calm-radio-online-streaming/id918425515?ls=1&amp;mt=8">Calm Radio</a> is now live in the App Store.</p>

<p><img src="https://bendodson.s3.amazonaws.com/apps/calm-radio-ios.jpg" width="800" height="640" /></p>

<p>Last month, I announced the launch of the <a href="https://bendodson.com/weblog/2016/01/13/calm-radio-for-apple-tv/">Apple TV app for Calm Radio</a>; the client was so pleased with the end result that they commissioned me to also rebuild their existing universal iOS app. This is a special project for me as I didn’t only build the app from scratch, but I also designed it fully. With the Apple TV app, I took design cues from the stock apps provided by Apple such as Movies and TV Shows; with the iOS app, I’ve taken inspiration from that design and kept the vibrant backgrounds created by blurrding the rich artwork that was available for each channel.</p>

<p><img src="https://bendodson.s3.amazonaws.com/apps/calm-radio-flow.jpg" width="800" height="384" /></p>

<p>As well as the standard playback and support for up to 3 ambient channels, the iOS app adds many features not found in the Apple TV app; an alarm clock, sleep timer, ability to skip track, favouriting channels, and full support for streaming to AirPlay and Chromecast devices. I also included support for 3D Touch by making use of Quick Actions to show your most recently listened to stations directly on the app icon. In addition, the app inherits many new features that were first designed for the Apple TV app such as video backgrounds.</p>

<p><img src="https://bendodson.s3.amazonaws.com/apps/calm-radio-devices.jpg" width="800" height="426" /></p>

<p>One of the things I’m most proud of is the adaptability of the UI. The app can run in an incredible 20 different sizes and orientations<sup id="fnref:orientations" role="doc-noteref"><a href="#fn:orientations" class="footnote" rel="footnote">1</a></sup> based on the various iPhone and iPad sizes, portrait and landscape support, and the new split-screen modes available to more recent iPads.</p>

<p>I’m honoured that my work on the Apple TV app was so well received that I was able to bring the same design and functionality to the Calm Radio iOS app. You can <a href="https://itunes.apple.com/us/app/calm-radio-online-streaming/id918425515?ls=1&amp;mt=8">download Calm Radio from the App Store</a> or <a href="https://calmradio.com/">learn more on their website</a>. The app is free although certain features are limited to paid subscriptions.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:orientations" role="doc-endnote">
      <p>The full list is iPhone 4s (portrait), iPhone 5 (portrait), iPhone 6 (portrait), iPhone 6 Plus (portrait), iPhone 4s (landscape), iPhone 5 (landscape), iPhone 6 (landscape), iPhone 6 Plus (landscape), iPad Mini (portrait), iPad Mini (landscape), iPad Air (portrait), iPad Air (landscape), iPad Air (30% width split-screen portrait), iPad Air (25% width split-screen landscape), iPad Air (50% width split-screen landscape), iPad Pro (portrait), iPad Pro (landscape), iPad Pro (30% width split-screen portrait), iPad Pro (25% width split-screen landscape), and iPad Pro (50% width split-screen landscape). <a href="#fnref:orientations" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/01/27/divide-7-mind-missiles-internet-of-stuff/">The Divide #7 - Mind Missiles and The Internet of Stuff</a></h1>
			
			<time datetime="2016-01-27" pubdate=""><a href="/weblog/2016/01/27/divide-7-mind-missiles-internet-of-stuff/">January 27, 2016</a></time>
    	</header>
    	<div>
			<p>The 7th episode of <a href="http://thedivide.co.uk/">The Divide</a> podcast is now available. Chris, John, and myself discuss a number of cool pieces of internet enabled hardware you can go and buy today. We’ll give examples of how to connect your home together with IFTTT, HomeKit, and devices like the Arduino and I spend a lot of time discussing my beloved Hue light bulbs. It turns out that John wants more Raspberry Pi’s in his life, I want the new Tesla update, and Chris has an interesting idea for a TV show…</p>

<p>You can get The Divide from these fine outlets:</p>

<ul>
  <li><a href="https://itunes.apple.com/gb/podcast/the-divide/id1063410638">iTunes</a></li>
  <li><a href="https://overcast.fm/itunes1063410638/the-divide">Overcast</a></li>
  <li><a href="http://thedivide.co.uk/shows/itunes.xml">RSS</a> (for other podcast readers)</li>
  <li><a href="http://thedivide.co.uk/">The Divide website</a></li>
</ul>

<p>Don’t forget to leave a review on iTunes and follow us on Twitter via <a href="http://twitter.com/PodcastDivide">@PodcastDivide</a>.</p>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/01/20/music-tracker/">Music Tracker</a></h1>
			
			<time datetime="2016-01-20" pubdate=""><a href="/weblog/2016/01/20/music-tracker/">January 20, 2016</a></time>
    	</header>
    	<div>
			<p>I’m very happy to announce that my latest self-published app, <a href="https://dodoapps.io/music-tracker/">Music Tracker</a>, is now <a href="https://itunes.apple.com/us/app/music-tracker-automatic-tracking/id1062583712?ls=1&amp;mt=8">available on the App Store</a>.</p>

<p><img src="https://bendodson.s3.amazonaws.com/dodo/music-tracker-hero.jpg" width="800" height="542" /></p>

<p>Music Tracker is an iPhone app that keeps an eye on your music library and monitors additions, deletions, and any changes to your songs. With streaming becoming more popular, it is very easy for song metadata to change or for songs to disappear as licensing deals expire; with Music Tracker, you will always know when something in your library changes whether it was by you, a family member, or your streaming service.</p>

<p>I came up with the idea for Music Tracker after noticing that the amount of songs returned by iTunes was different to that in my Music app on my iPhone. This was due to a song I had in Apple Music that was no longer available in the UK and so had been automatically deleted from my iPhone and greyed out in my iTunes library on my mac. After a quick prototype, I had an app that would run on my phone and keep track of any deletions and additions so I’d be alerted if Apple altered my music. After a few weeks, there were several changes picked up by my app including a few songs that were just plain deleted and some that were completely altered (i.e. I had a studio recording of <em>Uptown Girl</em> by Billy Joel that was switched for a live recording - with Music Tracker, I could see this change and switch it out for a studio recording from a different album).</p>

<p>In my original prototype version, I actually exported the entire music library as a JSON file and uploaded it to GitHub<sup id="fnref:github" role="doc-noteref"><a href="#fn:github" class="footnote" rel="footnote">1</a></sup>. However, to make it work natively on the device without an internet connection I made use of the <a href="http://realm.io">Realm</a> mobile database which is fantastic and insanely fast. The entire process of extracting the metadata from your library, comparing it against the existing dataset saved in Realm, and then creating a log of changes, additions, and deletions takes around 2.2 seconds on a library of 10000 songs<sup id="fnref:mileage" role="doc-noteref"><a href="#fn:mileage" class="footnote" rel="footnote">2</a></sup> and allows a full activity feed showing changes on a granular level:</p>

<p><img src="https://bendodson.s3.amazonaws.com/dodo/music-tracker-flow.jpg" width="800" height="417" /></p>

<p>From a technical point of view, there are 3 different ways in which Music Tracker can update depending on the options you choose during setup:</p>

<ol>
  <li>
    <p>If you enable push notifications, then a silent push notification<sup id="fnref:silent" role="doc-noteref"><a href="#fn:silent" class="footnote" rel="footnote">3</a></sup> will be sent to your device once an hour that wakes up the app in the background and checks for any changes. This typically lasts around 2 seconds on a standard library of 10000 songs and in my opinion is a pretty clever way of getting around the fact that you can’t schedule background tasks on iOS.</p>
  </li>
  <li>
    <p>If you don’t enable push notifications, the app will make use of Background App Refresh (limited to once per hour) to do an update in the background in a similar way to the silent push notifications. These typically fire when the phone is connected to WiFi and a power source but mileage will vary depending on what apps you have installed (and for that reason I recommend the silent push option).</p>
  </li>
  <li>
    <p>If you go into iPhone settings and disable Background App Refresh, then the only way to update the library is to open the app and pull to refresh (or use the 3D Touch Quick Action if you have an iPhone 6s / 6s Plus).</p>
  </li>
</ol>

<p>Before finishing the app, I added full 3D touch support (both quick actions and “Peek and Pop”) and a basic Apple Watch app that allows you to see how many songs are in your library, and how many songs have been added, changed, or deleted today (along with name and artist of those tracks). In addition, there is a glance providing this information in a single screen and text-based complications for the Utility, Modular, and Mickey Mouse faces with a quick summary of your library today.</p>

<p><img src="https://bendodson.s3.amazonaws.com/dodo/music-tracker-watch.jpg" width="800" height="417" /></p>

<p>This was the first project in which I used <a href="https://fastlane.tools">Fastlane</a> for the provisioning profile, certificate generation, push notification setup, TestFlight, and iTunes Connect submission and I’d highly recommend it; so much simpler than doing those things manually! The TestFlight beta test was also well worth doing as with something like this I could only really test on a handful of devices but I needed to see load times on other devices and larger libraries - a big thank you to all of my beta testers. Once the app was submitted, I was honestly expecting the app to be rejected but it went straight through review without a problem<sup id="fnref:update" role="doc-noteref"><a href="#fn:update" class="footnote" rel="footnote">4</a></sup>.</p>

<p>The final thing to mention is an issue of privacy. I’m very proud of the fact that no data leaves your device from this app<sup id="fnref:analytics" role="doc-noteref"><a href="#fn:analytics" class="footnote" rel="footnote">5</a></sup> and I have a simple and transparent <a href="https://dodoapps.io/music-tracker/privacy/">Privacy Policy</a><sup id="fnref:summary" role="doc-noteref"><a href="#fn:summary" class="footnote" rel="footnote">6</a></sup>. However, I do think it is bizarre that iOS does not require any permissions dialogue when accessing the music library. I <a href="https://bendodson.com/weblog/2016/01/13/your-music-library-is-a-security-and-privacy-risk-on-ios/">wrote a post about this last week</a> detailing this big privacy flaw and I’ve submitted a bug report to Apple (<a href="https://openradar.appspot.com/radar?id=6078139771912192">rdar://24168798</a>) in the hope that a standard privacy alert will be added in iOS 10.</p>

<p>You can download <a href="https://itunes.apple.com/us/app/music-tracker-automatic-tracking/id1062583712?ls=1&amp;mt=8">Music Tracker on the App Store</a> (priced at $0.99 / £0.79) and learn more about it on my <a href="https://dodoapps.io/music-tracker/">Dodo Apps website</a>. If you are interested in reviewing Music Tracker or writing an article surrounding the privacy issue, you may can <a href="https://bendodson.s3.amazonaws.com/dodo/music-tracker-media-kit.zip">download the media kit</a> which contains more information along with screenshots, mockups, and app icons.</p>

<p>If you find Music Tracker useful, I’m always grateful for a review on the App Store. If you run into any issues or have feature requests, you can <a href="https://bendodson.com/contact/">contact me directly</a>.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:github" role="doc-endnote">
      <p>You can see how this looked by seeing the commit log at <a href="https://github.com/bendodson/music-library">https://github.com/bendodson/music-library</a> <a href="#fnref:github" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:mileage" role="doc-endnote">
      <p>Your mileage may vary depending on how many songs you have in your library and what device you are using; it’s obviously faster on an iPhone 6s than a 5s. The app requires a 64-bit processor due to this and so will not run on the iPhone 4s, 5, or 5c. <a href="#fnref:mileage" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:silent" role="doc-endnote">
      <p>The key part here is “silent”. These notifications wake up your phone and do some processing but you don’t receive any alerts, sounds, or badge icon updates unless you specifically opt-in to the “Summary Notification” within the settings panel (and that sends a simple text alert once per day if your library changed on the previous day). <a href="#fnref:silent" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:update" role="doc-endnote">
      <p>Although v1.0.1 was “In Review” for 3 days before approval. <a href="#fnref:update" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:analytics" role="doc-endnote">
      <p>There are no analytics or tracking of any kind. I did use <a href="http://parse.com/">Parse</a> during the beta test in order to save a basic log of library sizes and processing times but that has all been removed for the App Store version and can be checked with a network debugger like <a href="https://www.charlesproxy.com">Charles Proxy</a>. <a href="#fnref:analytics" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:summary" role="doc-endnote">
      <p>Summary: I really don’t want your data. <a href="#fnref:summary" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	<article>
		<header>
     		
				<h1><a href="/weblog/2016/01/13/your-music-library-is-a-security-and-privacy-risk-on-ios/">Your music library is a security and privacy risk on iOS</a></h1>
			
			<time datetime="2016-01-13" pubdate=""><a href="/weblog/2016/01/13/your-music-library-is-a-security-and-privacy-risk-on-ios/">January 13, 2016</a></time>
    	</header>
    	<div>
			<p><strong>UPDATE: Thanks to my raising this privacy concern, <a href="https://bendodson.com/weblog/2016/08/02/media-library-privacy-flaw-fixed-in-ios-10/">Apple have resolved this issue as of iOS 10</a>. I’ve left the old post below for posterity.</strong></p>

<p>Over the years Apple has put a lot of effort into making iOS secure and privacy focussed. You are prompted with dialogue boxes whenever an app tries to access your contacts, calendars, photos, or location and you need to confirm that you want to receive notifications. However, whilst developing <a href="https://dodoapps.io/music-tracker/">Music Tracker</a><sup id="fnref:musictracker" role="doc-noteref"><a href="#fn:musictracker" class="footnote" rel="footnote">1</a></sup> I discovered that there is no privacy prompt when a developer tries to access your library. In fact, they can access all of your music data as simply as this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">MPMediaQuery</span><span class="o">.</span><span class="nf">songsQuery</span><span class="p">()</span>
<span class="k">if</span> <span class="k">let</span> <span class="nv">items</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">items</span> <span class="p">{</span>
    <span class="k">for</span> <span class="n">item</span> <span class="k">in</span> <span class="n">items</span> <span class="p">{</span>
    	<span class="kt">NSLog</span><span class="p">(</span><span class="s">"Title: </span><span class="se">\(</span><span class="n">item</span><span class="o">.</span><span class="n">title</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>That’s just a basic example that’ll output the title of every song in your library but there is a lot of danger in that. This process happens completely silently and in my tests I was able to loop through a library of 10000 songs, put all the metadata in a JSON file<sup id="fnref:json" role="doc-noteref"><a href="#fn:json" class="footnote" rel="footnote">2</a></sup>, and upload it to a server in under 2 seconds!</p>

<p>But why is this a security or privacy risk? Off the top of my head, I can think of two massive risks:</p>

<ol>
  <li>
    <p>Your library says a lot about you<sup id="fnref:bwitched" role="doc-noteref"><a href="#fn:bwitched" class="footnote" rel="footnote">3</a></sup>. If an advertising company was able to get a complete list of your music library (along with changes to it over time) then they could very easily target you with specific ads. Added a lot of Taylor Swift recently? Here are some ads relevant to that.</p>
  </li>
  <li>
    <p>When iOS first came out there was something called a UDID which basically identified your device uniquely. This was used by marketers to track you across multiple apps and build up a profile. This was stopped by Apple a few years back and replaced with an advertising identifier which you can turn off and which can only be used between apps from the same company (where they are probably already tracking you). However, with a full music library, it would be fairly easy to track someone across multiple apps as periodic snapshots could be compared on a server.</p>
  </li>
</ol>

<p>I’ve no idea if apps are already doing this in the background silently but it is something that shouldn’t be able to happen. To that end, I’ve filed a bug report with Apple (<a href="https://openradar.appspot.com/radar?id=6078139771912192">rdar://24168798</a>) to ask that they implement the same privacy controls that they do for contacts, calendars, photos, and location; a prompt when an app tries to access this data and the ability to grant or reject that permission through the system wide settings. Hopefully this is something Apple will implement in iOS 10 – if you’d like to see this happen, please duplicate bug 24168798 in the <a href="https://bugreport.apple.com">Apple Bug Reporter</a> as that is the best way to bring it to their attention.</p>

<p><strong>Update, 20th Jan 2016:</strong> A few people have pointed out that the first beta of iOS 9.3 does have a new privacy setting for “Media Library”. However, this does not stop the above line of code and read-only access to your library; instead, it is part of a new feature that allows for apps to add songs to your iCloud Music Library but requires your permission to do so. Apps that use the MPMediaQuery above won’t even appear in the Media Library permissions page to disable so this is not the solution some think it is.</p>

<p><strong>Update, 23rd Feb 2016:</strong> Several articles are now linking to this and picking up on my comments about iOS 9.3 above and horribly misunderstanding what those new APIs do. I’ve published a <a href="https://bendodson.com/weblog/2016/02/23/details-on-ios-9-3-media-library-additions/">new article detailing exactly what the new APIs in iOS 9.3 add to the music library</a> (and what they don’t add). As of iOS 9.3 beta 4, there are no privacy controls on scanning your music library and it still works exactly as I’ve described above.</p>

<p><strong>Update, 25th March 2016:</strong> With the public release of iOS 9.3, this issue is not resolved <a href="https://bendodson.com/weblog/2016/02/23/details-on-ios-9-3-media-library-additions/">as per my post last month</a>.</p>

<p><strong>Update, 13th June 2016:</strong> Thanks to my raising awareness of this issue, iOS 10 (released in beta for developers today) has added full privacy controls for read access to the local media library. I’ll write up a post in the future about how the new APIs work (<a href="https://bendodson.com/weblog/2016/08/02/media-library-privacy-flaw-fixed-in-ios-10/">done</a>).</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:musictracker" role="doc-endnote">
      <p><a href="https://itunes.apple.com/us/app/music-tracker-automatic-tracking/id1062583712?ls=1&amp;mt=8">Available on the App Store</a>. Find out more at <a href="https://dodoapps.io/music-tracker/">Dodo Apps</a>. <a href="#fnref:musictracker" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:json" role="doc-endnote">
      <p>I <a href="https://github.com/bendodson/music-library">uploaded it to GitHub</a> so you can get a feel for how big a file it generates in that small amount of time. <a href="#fnref:json" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:bwitched" role="doc-endnote">
      <p>Let’s not read into what <a href="https://itun.es/gb/Tr4Wr?i=298026101"><em>C’est La Vie</em> by B*Witched</a> means about me… <a href="#fnref:bwitched" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

		</div>
	</article>
    
	
</section>


<section id="pagination">
     
    	<a href="/weblog/page/10/" title="Previous Page" class="pagination-previous">&laquo; Older Entries</a>
     
	
    
      
      	<a href="/weblog/page/8/" title="Next Page" class="pagination-next">Newer Entries &raquo; </a>
      
    
</section>

		
		<footer>
			<p>I perform all freelance work through my company <strong>Dodo Apps Ltd</strong> (07856552) registered at The Bristol Office, 2nd Floor, 5 High Street, Westbury on Trym, Bristol, England, BS9 3BY</p>
		</footer>

	</div>


</body>
</html>